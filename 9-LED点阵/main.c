#include <REGX52.H>

#include <INTRINS.H>

typedef unsigned int u16;
typedef unsigned char u8;

//使用文字取模软件

//显示A
u8 LED_A = {0x00,0xFE,0x21,0x21,0x21,0x21,0xFE,0x00};
u8 LED_B = {0x00,0xFE,0x92,0x92,0x92,0x92,0x6C,0x00};
u8 LED_C = {0x00,0xFE,0x92,0x92,0x92,0x92,0x6C,0x00};
u8 LED_D = {0x00,0xFF,0x81,0x81,0x81,0x81,0x7E,0x00};
u8 LED_E = {0x00,0xFE,0x92,0x92,0x92,0x92,0x92,0x00};
u8 LED_F = {0x00,0xFF,0x11,0x11,0x11,0x11,0x01,0x00};
u8 LED_G = {0x00,0x7E,0x81,0x81,0xA1,0xA1,0x62,0x00};
u8 LED_H = {0x00,0xFE,0x10,0x10,0x10,0x10,0xFE,0x00};
u8 LED_I = {0x00,0x00,0x00,0x81,0xFF,0x81,0x00,0x00};
u8 LED_J = {0x00,0x00,0x60,0x80,0x80,0x80,0x7F,0x00};
u8 LED_K = {0x00,0xFE,0x10,0x28,0x44,0x82,0x00,0x00};
u8 LED_L = {0x00,0xFF,0x80,0x80,0x80,0x80,0x80,0x00};
u8 LED_M = {0x00,0xFE,0x04,0x08,0x04,0xFE,0x00,0x00};
u8 LED_N = {0x00,0xFF,0x04,0x08,0x10,0x20,0xFF,0x00};
u8 LED_O = {0x00,0x7E,0x81,0x81,0x81,0x81,0x7E,0x00};
u8 LED_P = {0x00,0xFE,0x11,0x11,0x11,0x11,0x0E,0x00};
u8 LED_Q = {0x00,0x7E,0x81,0x81,0xA1,0xC1,0xFE,0x00};
u8 LED_R = {0x00,0xFE,0x22,0x22,0x22,0xDC,0x00,0x00};
u8 LED_S = {0x00,0x26,0x49,0x49,0x49,0x32,0x00,0x00};
u8 LED_T = {0x00,0x01,0x01,0xFF,0x01,0x01,0x00,0x00};
u8 LED_U = {0x00,0x7E,0x80,0x80,0x80,0x7E,0x00,0x00};
u8 LED_V = {0x00,0x1F,0x20,0x40,0x80,0x40,0x20,0x1F};
u8 LED_W = {0x00,0xFF,0x40,0x20,0x10,0x20,0x40,0xFF};
u8 LED_X = {0x00,0x00,0xC6,0x28,0x10,0x28,0xC6,0x00};
u8 LED_Y = {0x00,0x07,0x08,0x70,0x08,0x07,0x00,0x00};
u8 LED_Z = {0x00,0xC1,0xA1,0x91,0x89,0x85,0x83,0x00};

//图形， 爱心
u8 LED_LOVE = {0x1C,0x3E,0x7E,0xFC,0xFC,0x7E,0x3E,0x1C};

// 74HC595芯片低第14个管脚，串行数据输入
sbit SER = P3^4;

//74HC595芯片低第12个管脚,存储寄存器时钟输入
sbit RCLK = P3^5;

//74HC595芯片低第11个管脚,移位寄存器时钟输入
sbit SRCLK = P3^6;
sbit LED = P0^7;

u8 ledNum;

//count=1 时，大约延时 10us
void delay(u16 count){
    while (i--);
}

//向74H595发送一个字节的数据
void Hc595SendByte(u8 dat){
    u8 a;
    SRCLK = 1;
    RCLK = 1;

    for(a=0; a<8; a++){
        SER = dat >> 7;
        dat <<= 1;

        //发送时序
        SRCLK = 0;
        _nop_();
        _nop_();
        SRCLK = 1;

    }
    RCLK = 0;
    _nop_();
    _nop_();
    RCLK = 1;
}

void main(){

    LED = 0;
    ledNum = ~0x01;
    while (1)
    {
       Hc595SendByte(ledNum);
       
           //左移函数将 ledNum 中的 0 进行移位
       ledNum = _crol_(ledNUm,1);

       delay(50000);
    }
    
}